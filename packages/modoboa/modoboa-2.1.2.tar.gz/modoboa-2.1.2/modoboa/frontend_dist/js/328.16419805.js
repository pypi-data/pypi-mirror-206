"use strict";(self["webpackChunkModoboa"]=self["webpackChunkModoboa"]||[]).push([[328],{1349:function(e,t,s){s.d(t,{Z:function(){return m}});var o=s(9884),i=s(7808),r=function(){var e=this,t=e._self._c;return t("validation-observer",{ref:"observer"},[t("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Username")))]),t("email-field",{ref:"username",attrs:{"error-messages":s,placeholder:e.usernamePlaceholder,type:e.usernameInputType},on:{input:e.update},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})]}}])}),t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("First name")))]),t(i.Z,{attrs:{autocomplete:"new-password",outlined:"",dense:""},on:{input:e.update},model:{value:e.form.first_name,callback:function(t){e.$set(e.form,"first_name",t)},expression:"form.first_name"}}),t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Last name")))]),t(i.Z,{attrs:{autocomplete:"new-password",outlined:"",dense:""},on:{input:e.update},model:{value:e.form.last_name,callback:function(t){e.$set(e.form,"last_name",t)},expression:"form.last_name"}}),t("account-password-form",{ref:"passwordForm",attrs:{account:e.form},on:{input:e.update},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),t(o.Z,{attrs:{label:e._f("translate")("Enabled"),dense:""},on:{input:e.update},model:{value:e.form.is_active,callback:function(t){e.$set(e.form,"is_active",t)},expression:"form.is_active"}})],1)},a=[],n=s(9950),l=s(422),d={components:{AccountPasswordForm:n.Z,EmailField:l.Z},props:["value","account"],data(){return{form:{}}},computed:{usernamePlaceholder(){return"SimpleUsers"===this.form.role?this.$gettext("Enter an email address"):this.$gettext("Enter a simple username or an email address")},usernameInputType(){return"SimpleUsers"===this.form.role?"email":"text"}},methods:{reset(){this.form={}},async validateForm(){return await this.$refs.observer.validate()&&await this.$refs.passwordForm.validate()},update(){console.log(this.form),this.$emit("input",this.form)}},mounted(){this.form={...this.value}}},u=d,c=s(1001),h=(0,c.Z)(u,r,a,!1,null,null,null),m=h.exports},3153:function(e,t,s){s.d(t,{Z:function(){return h}});var o=s(9884),i=s(7808),r=function(){var e=this,t=e._self._c;return t("validation-observer",{ref:"observer"},[t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Quota")))]),t(o.Z,{attrs:{label:e.useDomainQuotaLabel},on:{change:e.update},model:{value:e.form.mailbox.use_domain_quota,callback:function(t){e.$set(e.form.mailbox,"use_domain_quota",t)},expression:"form.mailbox.use_domain_quota"}}),e.form.mailbox.use_domain_quota?e._e():t("validation-provider",{attrs:{rules:"",vid:"quota"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t(i.Z,{attrs:{placeholder:e._f("translate")("Ex: 10MB. Leave empty for no limit"),hint:e._f("translate")("Quota for this mailbox, can be expressed in KB, MB (default) or GB. Define a custom value or use domain's default one. Leave empty to define an unlimited value (not allowed for domain administrators)."),"persistent-hint":"",outlined:"","error-messages":s,dense:""},on:{input:e.update},model:{value:e.form.mailbox.quota,callback:function(t){e.$set(e.form.mailbox,"quota",t)},expression:"form.mailbox.quota"}})]}}],null,!1,3906384436)}),t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Daily message sending limit")))]),t(i.Z,{attrs:{placeholder:e._f("translate")("Leave empty for no limit"),hint:e._f("translate")("Number of messages this mailbox can send per day. Leave empty for no limit."),"persistent-hint":"",outlined:"",dense:""},on:{input:e.update},model:{value:e.form.mailbox.message_limit,callback:function(t){e.$set(e.form.mailbox,"message_limit",t)},expression:"form.mailbox.message_limit"}})],1)},a=[],n=s(629),l={props:["value"],data(){return{form:{mailbox:{}}}},computed:{...(0,n.Se)({getDomainByName:"identities/getDomainByName"}),domainQuota(){const e=this.form.mailbox.full_address;if(e&&-1!==e.indexOf("@")){const t=this.getDomainByName(e.split("@")[1]);if(t)return parseInt(t.default_mailbox_quota)}},useDomainQuotaLabel(){let e=this.$gettext("Use domain default value");return void 0!==this.domainQuota&&(0===this.domainQuota?e+=` (${this.$gettext("unlimited")})`:e+=` (${this.domainQuota} MB)`),e}},methods:{reset(){this.form={mailbox:{}}},update(){this.$emit("input",this.form)}},mounted(){this.form={...this.value}},watch:{value:{handler(e){this.form={...e},"SimpleUsers"===this.form.role&&this.$set(this.form.mailbox,"full_address",this.form.username)},deep:!0}}},d=l,u=s(1001),c=(0,u.Z)(d,r,a,!1,null,"6edb579e",null),h=c.exports},9950:function(e,t,s){s.d(t,{Z:function(){return v}});var o=s(3694),i=s(4562),r=s(4324),a=s(9884),n=s(7808),l=function(){var e=this,t=e._self._c;return t("div",[t("validation-observer",{ref:"observer"},[e.withPasswordCheck?t("validation-provider",{attrs:{rules:"required|validPassword",mode:"lazy"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Current password")))]),t(n.Z,{attrs:{"error-messages":s,outlined:"",type:"password",dense:""},model:{value:e.form.currentPassword,callback:function(t){e.$set(e.form,"currentPassword",t)},expression:"form.currentPassword"}})]}}],null,!1,1082127803)}):e._e(),t("div",{staticClass:"d-flex align-center"},[t(a.Z,{attrs:{label:e._f("translate")("Random password"),dense:""},on:{change:e.updatePassword},model:{value:e.form.random_password,callback:function(t){e.$set(e.form,"random_password",t)},expression:"form.random_password"}}),e.form.random_password?[t(o.Z,{staticClass:"ml-6",staticStyle:{"background-color":"#515D78"},attrs:{dense:""}},[t("span",{staticClass:"white--text mr-4"},[e._v(e._s(e.form.password))]),t(i.Z,{attrs:{small:"",color:"white",icon:"",title:e._f("translate")("Copy to clipboard")},on:{click:e.copyPassword}},[t(r.Z,[e._v("mdi-clipboard-multiple-outline")])],1)],1)]:e._e()],2),e.form.random_password?e._e():t("validation-provider",{attrs:{rules:e.passwordRules,vid:"password"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Password")))]),t(n.Z,{attrs:{value:e.value,"error-messages":s,outlined:"",type:"password",dense:""},on:{input:t=>e.$emit("input",t)}})]}}],null,!1,3678330983)}),e.form.random_password?e._e():t("validation-provider",{attrs:{rules:e.passwordConfirmationRules,vid:"confirmation"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Confirmation")))]),t(n.Z,{attrs:{"error-messages":s,outlined:"",type:"password",dense:""},model:{value:e.form.password_confirmation,callback:function(t){e.$set(e.form,"password_confirmation",t)},expression:"form.password_confirmation"}})]}}],null,!1,1894999675)})],1)],1)},d=[],u=s(1589),c=s(9066),h={props:{value:String,withPasswordCheck:{type:Boolean,default:!1},account:{type:Object,required:!1}},data(){return{form:{}}},computed:{passwordRules(){return this.account&&this.account.pk?"":"required"},passwordConfirmationRules(){return this.value?"required|samePassword:password":""}},methods:{copyPassword(){navigator.clipboard.writeText(this.form.password).then((()=>{u.$.$emit("notification",{msg:this.$gettext("Password copied to clipboard")})}))},updatePassword(e){e?c.Z.getRandomPassword().then((e=>{this.$set(this.form,"password",e.data.password),this.$emit("input",this.form.password)})):(this.$set(this.form,"password",null),this.$set(this.form,"password_confirmation",null))},async validate(){return await this.$refs.observer.validate()}},mounted(){this.account&&(this.form.random_password=this.account.random_password,this.form.random_password&&this.updatePassword(!0))}},m=h,p=s(1001),f=(0,p.Z)(m,l,d,!1,null,null,null),v=f.exports},2690:function(e,t,s){s.d(t,{Z:function(){return p}});var o=s(3694),i=s(266),r=s(4324),a=s(1713),n=function(){var e=this,t=e._self._c;return t("validation-observer",{ref:"observer"},[t("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t(a.Z,[t(i.Z,{attrs:{cols:"7"}},[t("choice-field",{attrs:{value:e.account.role,label:e._f("translate")("Choose a role"),choices:e.accountRoles,"error-messages":s,"choices-per-line":2},on:{input:t=>e.$emit("input",t)}})],1),t(i.Z,{attrs:{cols:"5"}},[t(o.Z,{staticClass:"mt-11 ml-4 rounded-lg",attrs:{text:"",color:"primary"}},[t("h3",{staticClass:"headline"},[e._v(e._s(e.roleLabel))]),t("p",{staticClass:"mt-4"},[e._v(e._s(e.roleHelp))]),t(r.Z,{staticClass:"float-right",attrs:{color:"white",large:""}},[e._v("mdi-help-circle-outline")])],1)],1)],1)]}}])})],1)},l=[],d=s(3784),u={components:{ChoiceField:d.Z},props:["value","account"],computed:{roleLabel(){const e=this.accountRoles.find((e=>e.value===this.account.role));return void 0!==e?e.label:""},roleHelp(){const e=this.accountRoles.find((e=>e.value===this.account.role));return void 0!==e?e.help:""}},methods:{reset(){}},data(){return{accountRoles:[{label:this.$gettext("Domain administrator"),value:"DomainAdmins",help:this.$gettext("A user with privileges on one or more domain. He will be allowed to administer mailboxes and he can also have a mailbox.")},{label:this.$gettext("Reseller"),value:"Resellers",help:this.$gettext("help")},{label:this.$gettext("Simple user"),value:"SimpleUsers",help:this.$gettext("A user with no privileges but with a mailbox. He will be allowed to use all end-user features: webmail, calendar, contacts, filters.")},{label:this.$gettext("Super administrator"),value:"SuperAdmins",help:this.$gettext("A user with all privileges, can do anything. By default, such a user does not have a mailbox so he can't access end-user features.")}]}}},c=u,h=s(1001),m=(0,h.Z)(c,n,l,!1,null,null,null),p=m.exports},3784:function(e,t,s){s.d(t,{Z:function(){return u}});var o=s(4324),i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"text-subtitle-1 grey--text text--darken-1 mb-4",class:{"label--disabled":e.disabled}},[t("label",{staticClass:"m-label"},[e._v(e._s(e.label))])]),e._l(e.formatedChoices,(function(s,i){return t("div",{key:i,staticClass:"d-flex"},e._l(s,(function(s,i){return t("div",{key:i,staticClass:"choice rounded pa-10 mr-4 text-center flex-grow-0 mb-4",class:{"choice--disabled":e.disabled,"choice--selected":!e.disabled&&e.currentChoice===s.value},on:{click:function(t){return e.selectChoice(s.value)}}},[s.icon?t(o.Z,{staticClass:"d-block mb-2",attrs:{color:e.iconColor(s.value),"x-large":""}},[e._v(e._s(s.icon))]):e._e(),t("span",{staticClass:"grey--text text--darken-1"},[e._v(e._s(s.label))])],1)})),0)}))],2)},r=[],a=(s(7658),{props:{value:[Number,String],label:String,choices:Array,disabled:{type:Boolean,default:!1},choicesPerLine:Number},data(){return{currentChoice:null,formatedChoices:[]}},methods:{formatChoices(){if(this.choicesPerLine){let e=0;while(e<this.choices.length){const t=this.choices.slice(e,e+this.choicesPerLine);this.formatedChoices.push(t),e+=this.choicesPerLine}}else this.formatedChoices.push(this.choices)},iconColor(e){return this.disabled||e!==this.currentChoice?"":"primary"},selectChoice(e){this.disabled||(this.currentChoice=e,this.$emit("input",e))}},mounted(){this.formatChoices()},watch:{value:{handler(e){this.currentChoice=e},immediate:!0}}}),n=a,l=s(1001),d=(0,l.Z)(n,i,r,!1,null,"65541534",null),u=d.exports},422:function(e,t,s){s.d(t,{Z:function(){return p}});var o=s(5808),i=s(4525),r=s(9378),a=s(7808),n=function(){var e=this,t=e._self._c;return t("div",[t(a.Z,e._g(e._b({ref:"input",attrs:{outlined:"",dense:"",autocomplete:"new-password"},on:{input:e.update,keydown:e.onKeyDown},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},"v-text-field",e.$attrs,!1),e.$listeners)),e.showMenu?t("div",{staticClass:"menu",style:`width: ${e.width}px;`},[t(o.Z,{staticClass:"list"},e._l(e.filteredDomains,(function(s,o){return t(i.Z,{key:o,class:e.selectionIndex===o?"selected":"",on:{click:function(t){return e.selectDomain(s)}}},[t(r.V9,[e._v(e._s(s.name))])],1)})),1)],1):e._e()],1)},l=[],d=s(629),u={props:{value:String,allowAdd:{type:Boolean,default:!1}},computed:{...(0,d.Se)({domains:"identities/domains"}),filteredDomains(){return this.domains.filter((e=>e.name.startsWith(this.domainSearch)))}},data(){return{domainSearch:"",input:this.value,selectionIndex:0,showMenu:!1,width:500}},methods:{onKeyDown(e){const t=e.keyCode;40===t||34===t?(this.showMenu?this.increaseSelectionIndex():(this.domainSearch="",this.showMenu=!0),e.preventDefault()):38===t||33===t?(this.showMenu?this.decreaseSelectionIndex():(this.domainSearch="",this.showMenu=!0),e.preventDefault()):13===t||9===t?(this.filteredDomains.length>0?this.selectDomain(this.filteredDomains[this.selectionIndex]):this.allowAdd&&this.selectDomain(),e.preventDefault()):27===t&&this.filteredDomains.length>0&&(this.showMenu=!1,e.preventDefault())},increaseSelectionIndex(){this.selectionIndex>=this.filteredDomains.length-1?this.selectionIndex=0:this.selectionIndex+=1},decreaseSelectionIndex(){this.selectionIndex<=0?this.selectionIndex=this.filteredDomains.length-1:this.selectionIndex-=1},selectDomain(e){void 0!==e&&(this.input=this.input.split("@")[0]+"@"+e.name),this.showMenu=!1,this.$emit("input",this.input),this.$emit("domain-selected")},update(e){-1!==this.input.indexOf("@")?(this.domainSearch=this.input.split("@")[1],this.allowAdd?this.showMenu=this.filteredDomains.length>0:this.showMenu=!0):this.showMenu=!1,this.$emit("input",this.input)},onResize(){this.updateMinWidthProperty()},updateMinWidthProperty(){this.width=this.$refs.input.$el.clientWidth},reset(){this.input="",this.domainSearch=""}},mounted(){},updated(){this.$nextTick((()=>{this.updateMinWidthProperty()}))},watch:{value(e){this.input=e}}},c=u,h=s(1001),m=(0,h.Z)(c,n,l,!1,null,"db16b362",null),p=m.exports},3694:function(e,t,s){s.d(t,{Z:function(){return c}});var o=s(3434),i=s(6656),r=s(2240),a=s(1444),n=s(6669),l=s(4971),d=s(7678),u=s(4101),c=(0,d.Z)(o.Z,a.Z,l.Z).extend({name:"v-alert",props:{border:{type:String,validator(e){return["top","right","bottom","left"].includes(e)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(e){return"string"===typeof e||!1===e}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(e){return["info","error","success","warning"].includes(e)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let e={staticClass:"v-alert__border",class:{[`v-alert__border--${this.border}`]:!0}};return this.coloredBorder&&(e=this.setBackgroundColor(this.computedColor,e),e.class["v-alert__border--has-color"]=!0),this.$createElement("div",e)},__cachedDismissible(){if(!this.dismissible)return null;const e=this.iconColor;return this.$createElement(i.Z,{staticClass:"v-alert__dismissible",props:{color:e,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(r.Z,{props:{color:e}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(r.Z,{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const e={...o.Z.options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(e[`v-alert--border-${this.border}`]=!0),e},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&`$${this.type}`)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||n.Z.options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&(0,u.fK)("outline","outlined",this)},methods:{genWrapper(){const e=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],t={staticClass:"v-alert__wrapper"};return this.$createElement("div",t,e)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots.default)},genAlert(){let e={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const t=this.hasText?this.setTextColor:this.setBackgroundColor;e=t(this.computedColor,e)}return this.$createElement("div",e,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(e){const t=this.genAlert();return this.transition?e("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[t]):t}})},4971:function(e,t,s){var o=s(144);t["Z"]=o.ZP.extend({name:"transitionable",props:{mode:String,origin:String,transition:String}})},9066:function(e,t,s){var o=s(2201);const i="accounts";t["Z"]={getAll({domain:e,role:t}){return o.Z.get(`/${i}/`,{params:{domain:e,role:t}})},get(e){return o.Z.get(`${i}/${e}/`)},getRandomPassword(){return o.Z.get(`${i}/random_password`)},validate(e){return o.Z.post(`${i}/validate/`,e)},create(e){return o.Z.post(`${i}/`,e)},patch(e,t){return o.Z.patch(`${i}/${e}/`,t)},delete(e,t){return o.Z.post(`${i}/${e}/delete/`,t)}}}}]);
//# sourceMappingURL=328.16419805.js.map